<!DOCTYPE html>
<html>
<head>
<title>Browsermap client-side detection prototype</title>
<link rel="stylesheet" type="text/css" href="./style.css">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script type="text/javascript" src="./libs/browsermap/libs/browsermap/bmaputil.js"></script>
<script type="text/javascript" src="./libs/browsermap/libs/browsermap/bmap.js"></script>
<script type="text/javascript" src="./libs/browsermap/libs/externals/modernizr/modernizr.custom.js"></script>
<script type="text/javascript" src="./libs/externals/matchMedia.js/matchMedia.js"></script>
<script type="text/javascript" src="./libs/browsermap/libs/browsermap/probes.js"></script>
<script type="text/javascript" src="./libs/browsermap/libs/browsermap/devicegroups.js"></script>
</head>
<body>
    <div id="result">
        <p>
        The BrowserMap client-side detection prototype thinks your
        device type is <span id="devicegroup.description">UNIDENTIFIED??</span>,
        which is part of the <span id="devicegroup.name">NOT FOUND??</span> device group.
        </p>
    </div>
    <div id="description">
        <p>
            BrowserMap is a JavaScript browser features detection library. It uses modular probes and code snippets that detect
            specific features of the client, which can then be grouped in a simple way to create device groups. By identifying the client type,
            BrowserMap can help optimize page rendering or it can provide the client with alternate representations of the current page.
        </p>
        <br />
        <p>
            The following is a list of the device groups BrowserMap is capable of identifying. To override the detected device groups you can use the
            <code>device</code> <code>GET</code> request parameter. To showcase this behaviour, you can click on any device group name from below:
            <ol>
            <script type="text/javascript">
                var dgs = BrowserMap.getDeviceGroupsInRankingOrder(),
                    urlNoParams = window.location.href.replace(BrowserMapUtil.url.getURLParametersString(window.location.href), ''),
                    i;
                for (i = 0; i < dgs.length; i++) {
                    document.write('<li><a href="' + urlNoParams + '?device=' + dgs[i].name + '">' + dgs[i].name + '</a></li>');
                }
            </script>
            </ol>
        </p>
        <p>
            To reset the override, you need to call <a href="#" onclick="javascript:BrowserMap.removeOverride()"><code>BrowserMap.removeOverride()</code></a>.
        </p>
    </div>
    <div class="debug">
        <h3>Debugging Info</h3>
        <div class="console-output" id="debug.info">
        </div>
    </div>
    <script language="javascript">
        // Populate test page
        BrowserMap.forwardRequest();
        var matchedGroups = BrowserMap.getMatchedDeviceGroups(),
            matchedGroupsDescription = [],
            matchedGroupsNames = [],
            testFunctions = [],
            dgs = [],
            deviceGrps,
            g,
            element,
            i;
        for (g in matchedGroups) {
            matchedGroupsDescription.push(matchedGroups[g].description);
            matchedGroupsNames.push(matchedGroups[g].name);
            testFunctions.push(matchedGroups[g].testFunction);
        }
        deviceGrps = BrowserMap.getDeviceGroups();
        for (var g in deviceGrps) {
            dgs.push(deviceGrps[g].name);
        }

        element = document.getElementById('devicegroup.description');
        element.innerHTML = matchedGroupsDescription.join(', ')
        element = document.getElementById('devicegroup.name');
        element.innerHTML = matchedGroupsNames.join(', ');

        BrowserMap.debug('window.devicePixelRatio');
        BrowserMap.debug('window.orientation');
        BrowserMap.debug('navigator.vendor');
        BrowserMap.debug('navigator.platform');
        BrowserMap.debug('navigator.appName');
        BrowserMap.debug('navigator.appVersion');
        BrowserMap.debug('navigator.appCodeName');
        BrowserMap.debug('navigator.userAgent');

        BrowserMap.debug('screen.width');
        BrowserMap.debug('screen.availWidth');
        BrowserMap.debug('top.window.outerWidth');
        BrowserMap.debug('screen.height');
        BrowserMap.debug('screen.availHeight');
        BrowserMap.debug('top.window.outerHeight');

        BrowserMap.debug('Modernizr.touch');
        BrowserMap.debug('Modernizr.csstransforms3d');

        BrowserMap.debug('BrowserMap.probe("orientation")');
        BrowserMap.debug('BrowserMap.probe("portrait")');
        BrowserMap.debug('BrowserMap.probe("landscape")');
        BrowserMap.debug('BrowserMap.probe("devicePixelRatio")');
        BrowserMap.debug('BrowserMap.probe("canResizeBrowserWindow")');
        BrowserMap.debug('BrowserMap.probe("clientWidth")');
        BrowserMap.debug('BrowserMap.probe("clientWidthDependingOnOrientation")');
        BrowserMap.debug('BrowserMap.probe("screenWidthDependingOnOrientation")');

        element = document.getElementById('debug.info');
        for(i in BrowserMap.debuginfo) {
            element.innerHTML += i + '=' + BrowserMap.debuginfo[i] + '<br />';
        }
        element.innerHTML += '<br />';
        element.innerHTML += 'Test functions: <br />';
        for (i in testFunctions) {
            element.innerHTML += testFunctions[i] + '<br />';
        }
        element.innerHTML += '<br />';
    </script>
</body>
