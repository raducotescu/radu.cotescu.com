
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Securing WordPress from the ground up - Radu Cotescu's professional blog</title>
  <meta name="author" content="Radu Cotescu">

  
  <meta name="description" content="Learn how to protect your WordPress blog by following some advice on good practices.">
  <meta name="keywords" content="secure, wordpress, .htaccess, blog, hacker, wp-admin, plugins, security, proof">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://radu.cotescu.com/securing-wordpress-from-the-ground-up">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="http://feeds.cotescu.com/raducotescu" rel="alternate" title="Radu Cotescu's professional blog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-8815189-1']);
    _gaq.push(['_trackPageview']);
    _gaq.push(['_trackPageLoadTime']);
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <div class="top-nav">
    <ul>
        <li><a href="/" title="Home">127.0.0.1</a></li>
        <li><a href="/about/" title="About">About</a></li>
        <li><a href="/privacy-policy/" title="Privacy Policy">Privacy Policy</a></li>
        <li><a href="/calendar/" title="Calendar">Calendar</a></li>
        <li><a href="/resume/" title="Resume">Resume</a></li>
    </ul>
  </div>
  <header role="banner"><hgroup>
  <h1><a href="/">Radu Cotescu's professional blog</a></h1>
  
    <h2>g33k w17h pa45510n</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss email">
  <li><a href="http://feeds.cotescu.com/raducotescu" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
    <li><a href="http://feedburner.google.com/fb/a/mailverify?uri=raducotescu" rel="subscribe-email" title="subscribe via email">Email</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:radu.cotescu.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/category/-com">.com</a></li>
  <li><a href="/category/code">Code</a></li>
  <li><a href="/category/java">Java</a></li>
  <li><a href="/category/python">Python</a></li>
  <li><a href="/category/how-to">How To</a></li>
  <li><a href="/category/linux">Linux</a></li>
  <li><a href="/category/ubuntu">Ubuntu</a></li>
  <li><a href="/category/oracle">Oracle</a></li>
  <li><a href="/category/reviews">Reviews</a></li>
  <li><a href="/category/virtualization">Virtualization</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Securing WordPress From the Ground Up</h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-04-30T19:39:02+03:00" pubdate data-updated="true">Apr 30<span>th</span>, 2010</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>My <a href="http://radu.cotescu.com/hosted-by-hostgator/">move</a> to <a href="http://secure.hostgator.com/~affiliat/cgi-bin/affiliates/clickthru.cgi?id=raducotescu">HostGator</a> was partly due to the fact that on my old host this blog got hacked. And judging by the impact, I suspect this was a server-side security breach because my DB was intact. Since then I&#8217;ve spent some time to secure my WP instance as much as I could given the available tools on a shared hosting account.</p>

<p>While <a href="http://codex.wordpress.org/Hardening_WordPress">this</a> guide provides you a lot of information, it&#8217;s not diving into more detailed explanations. To sum it all up and to add some geeky stuff too, I recommend considering the following advice.</p>

<h3>Choose a secure host</h3>

<p>Assure that your hosting provider is secure: its servers are protected by unauthorized access, they <em>do</em> provide back-ups and they offer you a decent line of support services.</p>

<h3>Choosing passwords</h3>

<p>Use <em>strong</em> passwords: this is the most common overlooked aspect when it comes to security. Avoid your birth date, phone number, girlfriend&#8217;s / boyfriend&#8217;s name (unless it&#8217;s a very weird and uncommon name :D), etc. Avoid using every combination that could be guessed by people you know (it&#8217;s not paranoid, it has to protect your online space and therefore nobody but you should have access).</p>

<h3>Use up-to-date software</h3>

<p>Keep your WordPress engine and its plug-ins always up-to-date. This is pretty basic and helps you avoid security bugs that might exist in older versions.</p>

<h3>Secure your file transfers</h3>

<p>Avoid <a href="http://en.wikipedia.org/wiki/FTP">FTP</a> as much as you can: it&#8217;s <em>not</em> secure. Sure: it&#8217;s fast, it&#8217;s convenient and you might have a built-in client on your OS. But this doesn&#8217;t make it secure at all. Ask your host to provide you SSH access (this will be <a href="http://en.wikipedia.org/wiki/Chroot">chrooted</a> into your home folder) to be able to use <a href="http://en.wikipedia.org/wiki/SSH_file_transfer_protocol">SFTP</a>.</p>

<h3>File permissions</h3>

<p>Once you have set up your WordPress blog take care of file permissions (yes, it&#8217;s basic stuff, but again people overlook it). All your folders must have 755 permissions and all your files should have 644. Take special consideration for the <code>wp-config.php</code> file which is recommended to have 750 (on my server it has 600) and all the <code>.htaccess</code> files which should be writeable by the user under which your web server runs if you want WordPress and other plug-ins to able to modify them for you (permalinks, caching plugins, etc.).</p>

<h3>Secure wp-admin</h3>

<p>Protect your <code>wp-admin</code> folder using at least an <code>.htaccess</code> file for authentication (Basic HTTP Authentication). Another option is to use the <a href="http://wordpress.org/extend/plugins/askapache-password-protect/">AskApache Password Protection plugin</a>, but it doesn&#8217;t work on all hosts and several people have reported problems using it. To secure this folder with <code>.htaccess</code> you can use your hosting&#8217;s web administration panel (e.g. cPanel, Plesk, etc.) or you can directly upload the file having the following contents:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>ErrorDocument 401 default
</span><span class='line'>AuthType Basic
</span><span class='line'>AuthName <span class="s2">&quot;Use your imagination here&quot;</span>
</span><span class='line'>AuthUserFile <span class="s2">&quot;/path/that/is/upper/than/public_html/passwd&quot;</span>
</span><span class='line'>require valid-user
</span></code></pre></td></tr></table></div></figure>


<p>If you used  the web administration panel to do this, edit the generated <code>.htaccess</code> file in your <code>wp-admin</code> folder to include the first line from above, otherwise you will be locked-out of your Dashboard. If you haven&#8217;t used the web administration panel you must upload the <code>passwd</code> file which contains the user and the password you want for accessing any content from <code>wp-admin</code>. You can generate this file using <a href="http://web9.2020media.com/other/htpasswd.jsp">this</a> online script. The logic of keeping the passwords file outside of the directory used to serve content is to protect it from the outside world.</p>

<h3>Useful security plug-ins</h3>

<p>Personally I use four plug-ins which help me keep this blog clean of unwanted access:</p>

<ul>
<li><p><a href="http://wordpress.org/extend/plugins/login-lockdown/">Login LockDown</a> - this plug-in protects your blog from brute-force attacks on your login form. It can be set to block IPs from which several unsuccessful logins are performed. You can set the number of failed logins after which the IP should be blocked, the maximum number of minutes to allow unsuccessful login tries from the same IP and the number of minutes that the IPs should be blocked if breaching the first two rules.</p></li>
<li><p><a href="http://wordpress.org/extend/plugins/secure-wordpress/">Secure WordPress</a> - this plug-in hides certain information that your blog reveals and that might be used by hackers. Take care regarding the option labelled <code>index.php</code> because on some servers it might cause some problems where the server automatically requests itself for that file.</p></li>
<li><p><a href="http://wordpress.org/extend/plugins/exploit-scanner/">WordPress Exploit Scanner</a> - useful to search for potential security breaches in your WordPress&#8217; files, plug-ins and themes.</p></li>
<li><p><a href="http://wordpress.org/extend/plugins/wordpress-file-monitor/">WordPress File Monitor</a> - one of my favourites. This one checks if any changes have happened to your files while you were gone. It might cause some false alarms when you updateÂ  plug-ins of other files but if a hacker managed to alter your scripts you will find out soon enough (through email or notices on your Dashboard) and you can track which files he&#8217;s been playing with, making your recovery fast and clean.</p></li>
</ul>


<p>Another plug-in which can be used to track requests made to your server (although its main purpose is to show you statistics about your visitors) is <a href="http://wordpress.org/extend/plugins/statpress/">StatPress</a>. Using the database entries it creates, you can efficiently look through the records using the basic form it provides under its Search option or, if you know SQL, you can build custom queries to run against your DB to find out more.</p>

<h3>Extra</h3>

<p>If you think you have discovered some traces of an attack on your blog (fishy or bot-net requests) and you can clearly identify some specific data about the requests made (user-agent, IP, requests for certain files which shouldn&#8217;t be accessed directly), you can add these rules to the <code>.htaccess</code> file at the root of your blog:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># Hunting spammers</span>
</span><span class='line'>    RewriteEngine   on
</span><span class='line'><span class="c">#   RewriteCond     %{HTTP_REFERER}    ^$</span>
</span><span class='line'><span class="c">#   RewriteCond     %{HTTP_USER_AGENT} ^$</span>
</span><span class='line'><span class="c">#   RewriteCond     %{REQUEST_URI}     ^/denied/path/(.*)</span>
</span><span class='line'>    RewriteRule     ^<span class="o">(</span>.*<span class="o">)</span><span class="nv">$ </span>    http://%<span class="o">{</span>REMOTE_ADDR<span class="o">}</span>/      <span class="o">[</span>L,E<span class="o">=</span>nolog:1<span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Uncomment which rules you want to be used and edit them so that they catch what you need (a certain referrer, user-agent or a certain request). The result is that the &#8220;spammer&#8221; is given his own dog food in return without filling your server log with crap. It&#8217;s good to put this section at the beginning of your file so that if a spammer tries to do something bad, it will be redirected to his own IP without the server trying to parse the rest of the rules. Take care not to block access to your blog.</p>

<h3>Conclusion</h3>

<p>No matter how hard you try to keep your WordPress clean, there always is a slight chance that somebody some way will hack it. Although what I&#8217;ve tried to resume and present here are definitely show stoppers for your average hacker / script kiddie, it&#8217;s not as safe as not powering on any machine (from clients to servers). You will always be exposed to risk. The secret is to prevent any known chance of access without your consent.</p>

<p>Stay clean! :)</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Radu Cotescu</span></span>

      








  


<time datetime="2010-04-30T19:39:02+03:00" pubdate data-updated="true">Apr 30<span>th</span>, 2010</time>
      

<span class="categories">
  
    <a class='category' href='/category/-com/'>.com</a>, <a class='category' href='/category/how-to/'>How To</a>
  
</span>


    </p>
    
      <div class="sharing">
  
    <script type="text/javascript" src="http://www.reddit.com/static/button/button3.js"></script>
  
  
  	<a href="http://twitter.com/share" class="twitter-share-button" data-url="http://radu.cotescu.com/securing-wordpress-from-the-ground-up/" data-via="raducotescu" data-counturl="http://radu.cotescu.com/securing-wordpress-from-the-ground-up/" >Tweet</a>
  	
  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


  
  
  	<div class="g-plusone" data-size="medium"></div>
  	
  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>


  
  
    <div class="fb-like" data-send="true" data-width="350" data-show-faces="false"></div>
    
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>


  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/hosted-by-hostgator/" title="Previous Post: Hosted by HostGator">&laquo; Hosted by HostGator</a>
      
      
        <a class="basic-alignment right" href="/automated-cpanel-backup/" title="Next Post: Automated cPanel backup">Automated cPanel backup &raquo;</a>
      
    </p>
  </footer>
</article>

  <section style="margin-bottom: 30px">
    <div id="google-ads-comments" style="margin: 0 auto auto; text-align: center">
      <script type="text/javascript"><!--
        google_ad_client = "ca-pub-8659561010253809";
        /* NearCommentsBox468x60 */
        google_ad_slot = "0858986716";
        google_ad_width = 468;
        google_ad_height = 60;
      //-->
      </script>
      <script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
    </div>
  </section>
  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
    

<script type="text/javascript">
      var disqus_shortname = 'raducotescu';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://radu.cotescu.com/securing-wordpress-from-the-ground-up/';
        var disqus_url = 'http://radu.cotescu.com/securing-wordpress-from-the-ground-up/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/coloured-log-outputs/">Coloured log outputs on Unix/Linux</a>
      </li>
    
      <li class="post">
        <a href="/java-common-sense/">A useful rant on how people write Java code</a>
      </li>
    
      <li class="post">
        <a href="/tools-required-for-opening-a-macbook-pro/">Tools required for opening a MacBook Pro</a>
      </li>
    
      <li class="post">
        <a href="/the-switch-to-mac-from-ubuntu/">Switching to Mac from Ubuntu</a>
      </li>
    
      <li class="post">
        <a href="/migrating-your-ubuntu-machine-to-a-ssd-drive/">Migrating your Ubuntu machine to a SSD drive</a>
      </li>
    
  </ul>
</section>
<script type="text/javascript"><!--
google_ad_client = "ca-pub-8659561010253809";
/* Sidebar250x250 */
google_ad_slot = "8430472643";
google_ad_width = 250;
google_ad_height = 250;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>

<section>
  <h1>Latest Tweets</h1>
    <script charset="utf-8" src="http://widgets.twimg.com/j/2/widget.js"></script>
    <script>
    new TWTR.Widget({
      version: 2,
      type: 'profile',
      rpp: 5,
      interval: 30000,
      width: 250,
      height: 370,
      theme: {
        shell: {
          background: '#cfcfcf',
          color: '#ffffff'
        },
        tweets: {
          background: '#e8e8e8',
          color: '#4b4b4b',
          links: '#0182eb'
        }
      },
      features: {
        scrollbar: false,
        loop: false,
        live: true,
        behavior: 'all'
      }
    }).render().setUser('raducotescu').start();
    </script>
</section>



<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/106725941266744510645?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  &copy; 2009 - 2012 - Radu Cotescu -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  


</body>
</html>
