
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Migrating your Ubuntu machine to a SSD drive - Radu Cotescu's professional blog</title>
  <meta name="author" content="Radu Cotescu">

  
  <meta name="description" content="Find out how to easily migrate Ubuntu to a SSD drive.">
  <meta name="keywords" content="ssd,ubuntu,linux,migration,harddisk,smaller,rsync,ddrescue,partition,alignment,discard,noatime,nodiratime">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="https://radu.cotescu.com/migrating-your-ubuntu-machine-to-a-ssd-drive">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="http://feeds.cotescu.com/raducotescu" rel="alternate" title="Radu Cotescu's professional blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-8815189-1']);
    _gaq.push(['_trackPageview']);
    _gaq.push(['_trackPageLoadTime']);
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <div class="top-nav">
    <ul>
        <li><a href="/" title="Home">127.0.0.1</a></li>
        <li><a href="/about/" title="About">About</a></li>
        <li><a href="/privacy-policy/" title="Privacy Policy">Privacy Policy</a></li>
        <li><a href="/calendar/" title="Calendar">Calendar</a></li>
        <li><a href="/talks/" title="Talks">Talks</a>
        <li><a href="/resume/" title="Resume">Resume</a></li>
    </ul>
  </div>
  <header role="banner"><hgroup>
  <h1><a href="/">Radu Cotescu's professional blog</a></h1>
  
    <h2>g33k w17h pa45510n</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss email">
  <li><a href="http://feeds.cotescu.com/raducotescu" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
    <li><a href="https://feedburner.google.com/fb/a/mailverify?uri=raducotescu" rel="subscribe-email" title="subscribe via email">Email</a></li>
  
</ul>
  
<form action="https://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:radu.cotescu.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/category/-com">.com</a></li>
  <li><a href="/category/code">Code</a></li>
  <li><a href="/category/java">Java</a></li>
  <li><a href="/category/python">Python</a></li>
  <li><a href="/category/how-to">How To</a></li>
  <li><a href="/category/linux">Linux</a></li>
  <li><a href="/category/ubuntu">Ubuntu</a></li>
  <li><a href="/category/oracle">Oracle</a></li>
  <li><a href="/category/reviews">Reviews</a></li>
  <li><a href="/category/virtualization">Virtualization</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Migrating Your Ubuntu Machine to a SSD Drive</h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-05-11T23:10:00+03:00" pubdate data-updated="true">May 11<span>th</span>, 2012</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>SSD drives have finally become affordable and more reliable than they used to be. Partly this was sure helped by the price boost of the traditional hard-disks manufactured in Thailand (I think everybody still reminds the <a href="http://en.wikipedia.org/wiki/2011_Thailand_flood" title="2011 Thailand flood">floods</a> from the summer of 2011). The competition helped the development of innovative solutions and after 4 years since their mass-consumption breakthrough they have managed to become a standard on ultrabooks and premium laptops.</p>

<p>Because the price / GB of the classic mechanical hard-disk was so low (as low as US$0.05 per GB for 3.5 inch drives and US$0.10 per GB for 2.5 inch drives), producers started to offer larger drives for the same money. Unfortunately SSD technologies cannot and probably will not evolve the same way due to memory degradations once the chip size decreases. In particular this led to higher prices for the same disk size, making SSDs more attractive for boot / OS drives instead of plain storage ones.</p>

<p>Migrating a current OS installation usually has to take into consideration that the SSD destination disk might not be able to fully accommodate the previously stored data. The following paragraphs will describe what solutions can be employed in order to successfully migrate an Ubuntu installation (or any other Linux distribution) to a SSD drive.</p>

<!-- more -->


<h1>How To</h1>

<p>Depending on the available storage space of the SSD, there are two available solutions:</p>

<ol>
<li><p>the destination drive is just as big as the source drive, or larger &ndash; <code>ddrescue</code></p></li>
<li><p>the destination drive is smaller than the source drive &ndash; <code>rsync</code>, <code>gparted</code>, <code>boot-repair</code></p></li>
</ol>


<p>Tools needed for both solutions:</p>

<ol>
<li><p>an Ubuntu live CD / live USB stick from which to boot and perform the migration;</p></li>
<li><p>at least two SATA drives, one for the source and one for the destination disk;</p></li>
<li><p>at least two SATA data cables and two SATA power cables if you&#8217;re using a desktop machine to perform the migration, or a SATA to USB adaptor if you&#8217;re using a laptop;</p></li>
<li><p>a Philips screwdriver to mount / un-mount the hard drives and possibly the 3.5&#8221; adaptor.</p></li>
</ol>


<p>It&#8217;s time to connect the hard drives to your machine.</p>

<h2>1. Same size or larger SSD</h2>

<p>If the SSD you have installed on your machine is the same size or larger than your current mechanical drive it means that you&#8217;re rich. Furthermore, the work you have to do to migrate your system to the new drive does not require too much effort. <code>ddrescue</code> is a great tool for restoring information from failing drives but it can also be used to perform bitwise clones.</p>

<p>To start migrating your system from one drive to the other, perform the following steps:</p>

<ol>
<li><p>boot your machine using the live CD / USB stick;</p></li>
<li><p>enable the &#8220;universe&#8221; repositories on Ubuntu and install <code>gddrescue</code>:</p>

<pre><code> sudo apt-get update &amp;&amp; sudo apt-get install gddrescue
</code></pre></li>
<li><p>use <code>gddrescue</code> to clone your drive:</p>

<pre><code> sudo ddrescue -v --force /dev/sda /dev/sdb
</code></pre>

<p> where <code>/dev/sda</code> is your source drive and <code>/dev/sdb</code> is your destination drive</p></li>
<li><p>have patience; depending on your disk size and your machine&#8217;s performance this might take a while.</p></li>
</ol>


<p>At the end you should be able to seamlessly replace the old spinning drive with the SSD and just enjoy the snappiness of your system.</p>

<h2>2. Smaller SSD - the usual compromise</h2>

<p>Trying to clone a larger disk to a smaller one using <code>ddrescue</code> is not trivial, even if the total used storage space would be less than the SSD&#8217;s storage capacity. In this case three software tools of the *nix Swiss Army knife have to be used:</p>

<ol>
<li><p><code>gparted</code> &ndash; for setting out the partitioning layout;</p></li>
<li><p><code>rsync</code> &ndash; for selectively synchronising the needed data (you can easily decide what to exclude using patterns);</p></li>
<li><p><code>boot-repair</code> &ndash; to fix your Grub2 setup.</p></li>
</ol>


<h3>Partitioning with <code>gparted</code></h3>

<p>Boot your system using your live Ubuntu image. Using <code>gparted</code> (it is included on the live image) create the desired partitions on your SSD. Currently only 2 Linux file systems properly support SSDs (making use of native TRIM): <code>btrfs</code> and <code>ext4</code>. Out of these two, only <code>ext4</code> is considered mature enough to be used on production-ready systems, due to its mass-adoption in the Linux world.</p>

<p>In order to align your partitions with the drive&#8217;s sectors (for optimal performance and longevity) make sure to leave the first MiB of storage unallocated and to align your partitions to MiB, not cylinders. This is fairly intuitive with <code>gparted</code>.</p>

<p>Remember to add the <code>boot</code> flag to the partition where your <code>/boot</code> folder will be stored.</p>

<h3>Syncing with <code>rsync</code></h3>

<p>Once your SSD drive is partitioned, mount the source and destination partitions. This can easily be done from Nautilus, the default file browser from Ubuntu. Just open the home folder and on the left sidebar you can see the unmounted file systems. Click on them to let the system mount them automatically. I strongly recommend to mount them two by two (1 source, 1 destination) in order to avoid any complications. Using <code>rsync</code> selectively sync your partitions:</p>

<pre><code>    sudo rsync -a -v --exclude "excluded_folder_name_or_pattern" /media/&lt;source_uuid&gt;/ /media/&lt;destination_uuid&gt;
</code></pre>

<h3>Restoring <code>grub</code></h3>

<p>Unfortunately <code>rsync</code> will not be able to handle <code>grub</code>, thus you will not be able to boot your system. Restoring <code>grub</code> is very straight-forward. Again you will need the live CD / live USB stick to boot up your machine. After Ubuntu is up and running from the installation medium, you just need to install and use Boot-Repair. A very good guide is available <a href="https://help.ubuntu.com/community/Boot-Repair" title="Boot-Repair - Ubuntu Community Documentation">here</a>.</p>

<h2>Specific mount options for SSD</h2>

<p>Because of the way SSD drives work, some mount options need to be specified in your <code>/etc/fstab</code> file:</p>

<ul>
<li><code>discard</code> &ndash; this enables <a href="http://en.wikipedia.org/wiki/TRIM" title="TRIM explained on Wikipedia">TRIM</a>;</li>
<li><code>noatime</code> &ndash; this disables pointless writes to disk to store the last accessed time for a read file</li>
</ul>


<p>Your <code>fstab</code> file should look more or less like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># /etc/fstab: static file system information.</span>
</span><span class='line'><span class="c">#</span>
</span><span class='line'><span class="c"># Use &#39;blkid -o value -s UUID&#39; to print the universally unique identifier</span>
</span><span class='line'><span class="c"># for a device; this may be used with UUID= as a more robust way to name</span>
</span><span class='line'><span class="c"># devices that works even if disks are added and removed. See fstab(5).</span>
</span><span class='line'><span class="c">#</span>
</span><span class='line'><span class="c"># &lt;file system&gt; &lt;mount point&gt;   &lt;type&gt;  &lt;options&gt;       &lt;dump&gt;  &lt;pass&gt;</span>
</span><span class='line'>proc            /proc           proc    nodev,noexec,nosuid 0       0
</span><span class='line'><span class="nv">UUID</span><span class="o">=</span>0765430a-83ae-4530-b1b1-a976cd72ce16 /               ext4    discard,noatime,errors<span class="o">=</span>remount-ro             0 1
</span><span class='line'><span class="nv">UUID</span><span class="o">=</span>263bba00-32f4-4bea-966b-ab7ae1fc3e8b /home           ext4    discard,noatime,errors<span class="o">=</span>remount-ro,user_xattr  0 2
</span></code></pre></td></tr></table></div></figure>


<h1>Conclusions</h1>

<p>Migrating from your slow mechanical hard drive was easy. I am pretty sure that  if you have not used a SSD drive until now you will definitely question yourself why it took you so long to switch - I know I do. Sometimes we fail to remember that the hard-disk is still the slowest component in a computing system. A SSD might be the solution to speed up your machine instead of buying the newest and coolest CPU and it&#8217;s definitely cheaper as long as you can accommodate with less storage space for the drive that should store your OS and applications (and <em>maybe</em> your media workspace).</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Radu Cotescu</span></span>

      








  


<time datetime="2012-05-11T23:10:00+03:00" pubdate data-updated="true">May 11<span>th</span>, 2012</time>
      

<span class="categories">
  
    <a class='category' href='/category/how-to/'>How To</a>, <a class='category' href='/category/linux/'>Linux</a>, <a class='category' href='/category/ubuntu/'>Ubuntu</a>
  
</span>


    </p>
    
      <div class="sharing">
  
    <script type="text/javascript" src="http://www.reddit.com/static/button/button3.js"></script>
  
  
  	<a href="http://twitter.com/share" class="twitter-share-button" data-url="https://radu.cotescu.com/migrating-your-ubuntu-machine-to-a-ssd-drive/" data-via="raducotescu" data-counturl="https://radu.cotescu.com/migrating-your-ubuntu-machine-to-a-ssd-drive/" >Tweet</a>
  	
  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


  
  
  	<div class="g-plusone" data-size="medium"></div>
  	
  <script src="https://apis.google.com/js/platform.js" async defer></script>


  
  
    <div class="fb-like" data-send="true" data-width="350" data-show-faces="false"></div>
    
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>


  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/why-awk-is-better-than-cut/" title="Previous Post: Why awk is better than cut">&laquo; Why awk is better than cut</a>
      
      
        <a class="basic-alignment right" href="/the-switch-to-mac-from-ubuntu/" title="Next Post: Switching to Mac from Ubuntu">Switching to Mac from Ubuntu &raquo;</a>
      
    </p>
  </footer>
</article>

  <section style="margin-bottom: 30px">
    <div id="google-ads-comments" style="margin: 0 auto auto; text-align: center">
      <script type="text/javascript"><!--
        google_ad_client = "ca-pub-8659561010253809";
        /* NearCommentsBox468x60 */
        google_ad_slot = "0858986716";
        google_ad_width = 468;
        google_ad_height = 60;
      //-->
      </script>
      <script type="text/javascript" src="//pagead2.googlesyndication.com/pagead/show_ads.js"></script>
    </div>
  </section>
  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
    

<script type="text/javascript">
      var disqus_shortname = 'raducotescu';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'https://radu.cotescu.com/migrating-your-ubuntu-machine-to-a-ssd-drive/';
        var disqus_url = 'https://radu.cotescu.com/migrating-your-ubuntu-machine-to-a-ssd-drive/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/remapping-keys-in-ubuntu-14.04/">Remapping Keys in Ubuntu 14.04</a>
      </li>
    
      <li class="post">
        <a href="/coloured-log-outputs/">Coloured log outputs on Unix/Linux</a>
      </li>
    
      <li class="post">
        <a href="/java-common-sense/">A useful rant on how people write Java code</a>
      </li>
    
      <li class="post">
        <a href="/tools-required-for-opening-a-macbook-pro/">Tools required for opening a MacBook Pro</a>
      </li>
    
      <li class="post">
        <a href="/the-switch-to-mac-from-ubuntu/">Switching to Mac from Ubuntu</a>
      </li>
    
  </ul>
</section>
<script type="text/javascript"><!--
google_ad_client = "ca-pub-8659561010253809";
/* Sidebar250x250 */
google_ad_slot = "8430472643";
google_ad_width = 250;
google_ad_height = 250;
//-->
</script>
<script type="text/javascript"
src="https://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>

<section>
  <h2>Latest Tweets</h2>
  <a class="twitter-timeline" href="https://twitter.com/raducotescu" data-widget-id="323192190111203328">Tweets by @raducotescu</a>
  <script>
  !function(d,s,id) {
    var js,
        fjs = d.getElementsByTagName(s)[0],
        p = /^http:/.test(d.location) ? 'http' : 'https';
        if (!d.getElementById(id)) {
            js = d.createElement(s);
            js.id = id;
            js.src = p + "://platform.twitter.com/widgets.js";
            fjs.parentNode.insertBefore(js,fjs);
        }
  }(document,"script","twitter-wjs");
  </script>
</section>




<section class="googleplus">
  <h1>
    <a href="//plus.google.com/+RaduCotescu?rel=author">
      <img src="//www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  &copy; 2009 - 2014 - Radu Cotescu -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  


</body>
</html>
